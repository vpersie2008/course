## Node.js的模块系统 ##

####一、什么是模块系统？

为了让Node.js 文件可以相互调用，Node.js提供了一个简单的模块系统，模块是Node.js的重要组成部分，文件和模块是一一对应的，换言之，一个Node.js文件就是一个模块，
这个文件可能是JS代码、JSON、或者C/C++ 扩展。

#### 二、如何创建模块

**例如：**我们创建一个hello.js 的文件，那么这个文件就是一个模块，使用require(./hello) 将模块导入，即可使用模块中的内容。

代码如下：

    //hello.js
    exports.world = function() {
      console.log('Hello World');
    }
    
    //main.js
    var hello = require('./hello');
    hello.world();
    

####三、模块的分类、服务端模块到底放在哪里？

模块分类：模块分为**3种**，大体分为两类（原生核心模块和文件模块）

- **原生核心模块:** Node.js自己提供的模块，如http、fs等，这类模块不需要使用npm安装，因为是原生的。

- **第三方模块：** 一般从npmjs.com 上拉取的并安装的，如express、nodemon等，注意第三方模块不能和核心模块重名。

- **自定义模块：** 如自己创建的js文件，并导出使用的模块。


**例如：我们加载一个系统内置模块http，那么它是放在哪里的？具体如何加载？**

**图1，模块加载原理**

- **从文件模块缓存中加载**

尽管原生模块与文件模块优先级不同，但是都会优先从文件模块的缓存中加载已经存在的模块。

- **从原生模块加载：**

原生模块的优先级仅次于文件模块缓存的优先级，require方法在解析文件名之后，优先检查模块是否在原生模块列表中，例如本地存在一个http/http.js/http.node/http.json 的文件，
require('http') 都不会从那个文件中加载，而先会从原生模块http 中加载。

- **从文件中加载**

当文件模块缓存中不存在，且不是原生模块时，Node.js 会解析require 方法传入的参数，并从文件系统中加载实际的文件。


**综上：** **原生模块和文件模块都有缓存区，优先从缓存区加载模块-> 原生核心模块 -> 文件中模块**


#### 四、module.exopors 使用

- 见代码
